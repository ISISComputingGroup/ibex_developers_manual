

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Common config upgrade steps &mdash; IBEX Developer&#39;s Manual</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=e6a88b47" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Config Checker" href="Config-Checker.html" />
    <link rel="prev" title="Check db file script" href="Check-db-file.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >

          
          
          <a href="../index.html" class="icon icon-home">
            IBEX Developer's Manual
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Editing-the-Wiki.html">Editing this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Interfaces &amp; Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Client.html">IBEX GUI (Eclipse)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Script-Generator.html">Script Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Scripting.html">Scripting (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Web.html">Web Dashboard &amp; Chat</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IBEX Server &amp; Systems</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../System-components.html">Backend System Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IOCs.html">EPICS IOCs &amp; Support Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Specific-IOCs.html">Specific Devices &amp; IOCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Systems.html">Systems Administration &amp; Hardware</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Processes &amp; Tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Providing-Support.html">Providing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Deployment.html">Releases &amp; Deployment</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../Tools.html">Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Archive-Tools.html">Archive Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="CA-snooper.html">CA snooper</a></li>
<li class="toctree-l2"><a class="reference internal" href="Check-db-file.html">Check db file script</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Common config upgrade steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="Config-Checker.html">Config Checker</a></li>
<li class="toctree-l2"><a class="reference internal" href="Config-IOC-Finder.html">Config IOC Finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="Config-Upgrader.html">Config Upgrader</a></li>
<li class="toctree-l2"><a class="reference internal" href="Moxa-Tools.html">Moxa Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="Network-traffic.html">Networking tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="SSH-keys.html">SSH key-based auth</a></li>
<li class="toctree-l2"><a class="reference internal" href="Shared-utility-scripts.html">Shared Utility Scripts (<code class="docutils literal notranslate"><span class="pre">ibex_utils</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Processes.html">Processes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBEX Developer's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Tools.html">Tools</a></li>
      <li class="breadcrumb-item active">Common config upgrade steps</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ISISComputingGroup/ibex_developers_manual/blob/master/doc/tools/Common-config-upgrade-steps.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="common-config-upgrade-steps">
<h1>Common config upgrade steps<a class="headerlink" href="#common-config-upgrade-steps" title="Link to this heading"></a></h1>
<section id="changing-macros">
<h2>Changing macros<a class="headerlink" href="#changing-macros" title="Link to this heading"></a></h2>
<p>The classes for changing macro names and values use the <code class="docutils literal notranslate"><span class="pre">Macro</span></code> structure, which lets you specify the name of the IOC which is to be changed (e.g. <code class="docutils literal notranslate"><span class="pre">AMINT2L</span></code>), as well the value. There is a common interface to change macros in a globals.txt file, as well as the XML files in an instrument configuration.</p>
<p>When changing macros, you need to supply the name of the IOC and two <code class="docutils literal notranslate"><span class="pre">Macro</span></code> objects. The first Macro defines the <em>current</em> name of the macro to be found. If a value is supplied here (optional), only macros which match on the IOC name, macro name and value will be changed.</p>
<p>The second <code class="docutils literal notranslate"><span class="pre">Macro</span></code> object defines what the macro should look like <em>after</em> the upgrade step. You can keep the macro name the same as the first macro object but add a new/different value. The macro name can be different, which would change the name of the macro (the moxa e12xx upgrade step does this), no value needs to be supplied for this. Or you can change both the macro name and the value, which would change both.</p>
<section id="examples">
<h3>Examples:<a class="headerlink" href="#examples" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">macros_to_change</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;IP_ADDR&quot;</span><span class="p">),</span> <span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;ADDR&quot;</span><span class="p">)),</span>
<span class="p">]</span>
<span class="n">change_xml_macros</span><span class="o">.</span><span class="n">change_macros</span><span class="p">(</span><span class="s2">&quot;MOXA12XX&quot;</span><span class="p">,</span> <span class="n">macros_to_change</span><span class="p">)</span>
</pre></div>
</div>
<p>This is taken from the moxa 12XX upgrade step. It finds all existing MOXA12XX IOCs in configurations, and changes the name of the <code class="docutils literal notranslate"><span class="pre">IP_ADDR</span></code> macro to <code class="docutils literal notranslate"><span class="pre">ADDR</span></code>. The macro value is not changed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">macros_to_change</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;ADDR&quot;</span><span class="p">),</span> <span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;ADDR&quot;</span><span class="p">,</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)),</span>
<span class="p">]</span>
<span class="n">change_xml_macros</span><span class="o">.</span><span class="n">change_macros</span><span class="p">(</span><span class="s2">&quot;MOXA12XX&quot;</span><span class="p">,</span> <span class="n">macros_to_change</span><span class="p">)</span>
</pre></div>
</div>
<p>This sets the value of all <code class="docutils literal notranslate"><span class="pre">ADDR</span></code> macros on MOXA12XX IOCs to 127.0.0.1. This is because no macro value has been specified in the first macro, so it updates the value regardless of what the current value of the macro is.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">macros_to_change</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;ADDR&quot;</span><span class="p">,</span> <span class="s2">&quot;8.8.8.8&quot;</span><span class="p">),</span> <span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;ADDR&quot;</span><span class="p">,</span> <span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)),</span>
    <span class="p">(</span><span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;BAUDRATE&quot;</span><span class="p">),</span> <span class="n">Macro</span><span class="p">(</span><span class="s2">&quot;BAUD&quot;</span><span class="p">,</span> <span class="s2">&quot;9600&quot;</span><span class="p">)),</span>

<span class="p">]</span>
<span class="n">change_xml_macros</span><span class="o">.</span><span class="n">change_macros</span><span class="p">(</span><span class="s2">&quot;MOXA12XX&quot;</span><span class="p">,</span> <span class="n">macros_to_change</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple macros can be passed through in the list. Here, the same operation as above is performed except only <code class="docutils literal notranslate"><span class="pre">ADDR</span></code> macros currently set to 8.8.8.8 will be changed. Also, MOXA12XX IOCs with a <code class="docutils literal notranslate"><span class="pre">BAUDRATE</span></code> macros defined get renamed to <code class="docutils literal notranslate"><span class="pre">BAUD</span></code>, with their value set to 9600.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Check-db-file.html" class="btn btn-neutral float-left" title="Check db file script" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Config-Checker.html" class="btn btn-neutral float-right" title="Config Checker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Oct 31, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>