

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mezei spin flipper &mdash; IBEX Developer&#39;s Manual</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=e6a88b47" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Power distribution units" href="../Power-Distribution-Unit-%28PDU%29.html" />
    <link rel="prev" title="CRISP Spin Flipper" href="CRISP-Spin-Flipper.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >

          
          
          <a href="../../index.html" class="icon icon-home">
            IBEX Developer's Manual
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Editing-the-Wiki.html">Editing this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Interfaces &amp; Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Client.html">IBEX GUI (Eclipse)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Script-Generator.html">Script Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Scripting.html">Scripting (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Web.html">Web Dashboard &amp; Chat</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IBEX Server &amp; Systems</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../System-components.html">Backend System Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../IOCs.html">EPICS IOCs &amp; Support Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Cells.html">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Choppers.html">Choppers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cryogenics.html">Cryogenics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DAE-and-the-ICP.html">DAE (Data Acquisition Electronics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DAQ.html">DAQ (NI cDAQ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Datastreaming.html">Data Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fluxgates.html">Fluxgates &amp; Magnetometers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gas-And-Liquid-Handling-Systems.html">Gas and liquid handling systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging-Cameras.html">Imaging Cameras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Loading-Rigs.html">Loading rigs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Magnets.html">Magnets &amp; Large Power Supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Motors.html">Motors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Motors-Extensions.html">Motor Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Multimeters.html">Multimeters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Other.html">Other / Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PLCs.html">PLCs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Polarisers-and-Analysers.html">Polarisers &amp; Analysers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="CRISP-Spin-Flipper.html">CRISP Spin Flipper</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mezei spin flipper</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Power-Distribution-Unit-%28PDU%29.html">Power distribution units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Power-Supplies.html">Power supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Pressure-Monitors.html">Pressure monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reflectometry-IOC.html">Reflectometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Rheometers.html">Rheometers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sample-Changers.html">Sample Changers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sensors.html">Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Signal-Generators.html">Signal Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Temperature-Controllers.html">Temperature Controllers</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Processes &amp; Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Providing-Support.html">Providing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deployment.html">Releases &amp; Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Processes.html">Processes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IBEX Developer's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a></li>
          <li class="breadcrumb-item"><a href="../Polarisers-and-Analysers.html">Polarisers &amp; Analysers</a></li>
      <li class="breadcrumb-item active">Mezei spin flipper</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ISISComputingGroup/ibex_developers_manual/blob/master/doc/specific_iocs/polarisers_and_analysers/Mezei-Spin-Flipper.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="mezei-spin-flipper">
<h1>Mezei spin flipper<a class="headerlink" href="#mezei-spin-flipper" title="Link to this heading"></a></h1>
<section id="hardware-versions">
<h2>Hardware versions<a class="headerlink" href="#hardware-versions" title="Link to this heading"></a></h2>
<p>There are two versions of the Mezei flipper hardware in use, and so the IOC and OPI have two versions to cope with these differences</p>
<section id="v1">
<h3>V1<a class="headerlink" href="#v1" title="Link to this heading"></a></h3>
<p>This hardware is in use on POLREF. It was originally in use by LET, but was superseded by V2 (which has been set back to V1 because of communication issues as of 16/11/2020) in <a class="reference external" href="https://github.com/ISISComputingGroup/IBEX/issues/4871">https://github.com/ISISComputingGroup/IBEX/issues/4871</a> .</p>
<p>If you need to use V1 hardware, you should set the following macros in <code class="docutils literal notranslate"><span class="pre">globals.txt</span></code> to enable support for the old protocol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MEZFLIPR_01__PROTOCOL_VERSION</span><span class="o">=</span><span class="mi">1</span>
<span class="n">MEZFLIPR_01__POLARISERPRESENT</span><span class="o">=</span><span class="n">yes</span>
<span class="n">MEZFLIPR_01__ANALYSERPRESENT</span><span class="o">=</span><span class="n">yes</span>
</pre></div>
</div>
<p>For this hardware, use the <code class="docutils literal notranslate"><span class="pre">Mezei</span> <span class="pre">flipper</span> <span class="pre">(v1)</span></code> OPI.</p>
</section>
<section id="v2">
<h3>V2<a class="headerlink" href="#v2" title="Link to this heading"></a></h3>
<p>This is newer hardware which is now in use on LET. POLREF plan to eventually also migrate to this hardware, however, this has not been done as of September 2020.</p>
<p>V2 hardware is assumed by default in the ioc; no special configuration is required to use it. It should use the <code class="docutils literal notranslate"><span class="pre">Mezei</span> <span class="pre">flipper</span></code> OPI.</p>
<p>The port used by default is 80. As of <a class="reference external" href="https://github.com/ISISComputingGroup/IBEX/issues/7206">#7206</a> we now enforce that this is added to the <code class="docutils literal notranslate"><span class="pre">HOST</span></code> macro.</p>
</section>
</section>
<section id="hardware">
<h2>Hardware<a class="headerlink" href="#hardware" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>There is a python script <strong>running on a separate PC</strong> (LET:NDW1889, POLREF:NDW1937) which controls some DAQ units</p></li>
<li><p>This python script reads the timing pulse (this can come from the synchrotron or a chopper) and controls the flipper</p></li>
<li><p>The python script exposes a TCP connection</p></li>
<li><p>The python script is available in <code class="docutils literal notranslate"><span class="pre">\shares\ISIS_Experiment_Controls\external_code\Mezei</span> <span class="pre">Neutron</span> <span class="pre">Spin</span> <span class="pre">Flipper</span></code></p></li>
<li><p>The current LabVIEW and IBEX drivers, running on the NDX instrument control PC, use this TCP connection to talk to the flipper system</p></li>
<li><p>There is also some optimization code. This is an instrument script which runs on the NDX machine and communicates with PVs via genie_python. This is what determines the mode and parameters which the flipper will run with. Therefore these modes and parameters are not expected to be set manually.</p></li>
</ul>
<p>See also some of the comments in <a class="reference external" href="https://github.com/ISISComputingGroup/IBEX/issues/3738">https://github.com/ISISComputingGroup/IBEX/issues/3738</a> and <a class="reference external" href="https://github.com/ISISComputingGroup/IBEX/issues/4871">https://github.com/ISISComputingGroup/IBEX/issues/4871</a> for further details of the hardware setup.</p>
<p>The flipper can run in one of four different mode:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Constant current</p></td>
<td><p>Does what it says on the tin - a simple constant current is supplied to the magnet coils</p></td>
</tr>
<tr class="row-odd"><td><p>Steps</p></td>
<td><p>On LET, they use RRM (repetition-rate multiplication) to select multiple incident energies per neutron pulse (frame). Running the flipper in “steps” mode supplies a different current to the coils for each incident energy.</p></td>
</tr>
<tr class="row-even"><td><p>Analytical</p></td>
<td><p>This mode varies the current to the coils as a function of time, within each neutron pulse. The equation being modelled is <code class="docutils literal notranslate"><span class="pre">I</span> <span class="pre">=</span> <span class="pre">A</span> <span class="pre">/</span> <span class="pre">(t</span> <span class="pre">+</span> <span class="pre">t0)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>File</p></td>
<td><p>This mode uses a file as a lookup table to determine current to the flipper coils as a function of time within each neutron pulse</p></td>
</tr>
</tbody>
</table>
<p>Each mode takes a “parameter”, which is passed to the flipper as a string. It is passed to the flipper as a string to allow arbitrarily complex data structures to be transmitted to the python code which controls the flipper (for example, a common case is to pass a python list as the parameter). These parameters are only ever written to by an optimization script running on the NDX computer.</p>
<p>The other variables which the flipper can take are:</p>
<ul class="simple">
<li><p><strong>Power</strong>: power to the coils on/off.</p></li>
<li><p><strong>Compensation</strong>: a fixed current which is always added to whatever value the lookups provide, to compensate for changes caused by the flipper kit itself.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CRISP-Spin-Flipper.html" class="btn btn-neutral float-left" title="CRISP Spin Flipper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Power-Distribution-Unit-%28PDU%29.html" class="btn btn-neutral float-right" title="Power distribution units" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Feb 27, 2026.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>