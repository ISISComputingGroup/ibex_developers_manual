

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Testing &mdash; IBEX Developer&#39;s Manual</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=e6a88b47" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Troubleshooting" href="Reflectometry-Troubleshooting-and-FAQ.html" />
    <link rel="prev" title="Glossary" href="Reflectometry-Glossary.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >

          
          
          <a href="../../index.html" class="icon icon-home">
            IBEX Developer's Manual
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Editing-the-Wiki.html">Editing this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Interfaces &amp; Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Client.html">IBEX GUI (Eclipse)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Script-Generator.html">Script Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Scripting.html">Scripting (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Web.html">Web Dashboard &amp; Chat</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IBEX Server &amp; Systems</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../System-components.html">Backend System Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../IOCs.html">EPICS IOCs &amp; Support Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Cells.html">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Choppers.html">Choppers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cryogenics.html">Cryogenics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DAE-and-the-ICP.html">DAE (Data Acquisition Electronics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DAQ.html">DAQ (NI cDAQ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Datastreaming.html">Data Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fluxgates.html">Fluxgates &amp; Magnetometers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gas-And-Liquid-Handling-Systems.html">Gas and liquid handling systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging-Cameras.html">Imaging Cameras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Loading-Rigs.html">Loading rigs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Magnets.html">Magnets &amp; Large Power Supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Motors.html">Motors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Motors-Extensions.html">Motor Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Multimeters.html">Multimeters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Other.html">Other / Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PLCs.html">PLCs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Polarisers-and-Analysers.html">Polarisers &amp; Analysers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Power-Distribution-Unit-%28PDU%29.html">Power distribution units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Power-Supplies.html">Power supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Pressure-Monitors.html">Pressure monitors</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Reflectometry-IOC.html">Reflectometry</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Beamlines.html">Beamline-specific information</a></li>
<li class="toctree-l3"><a class="reference internal" href="Config-Training.html">Reflectometry Config Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="Design-Docs.html">Reflectometry Design Documents</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometers-Beam-Height-Calc.html">Beam height calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Alignment.html">Alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Beam-Blocker.html">Beam Blocker</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Beamline-Object.html">Beamline object</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Beamline-Parameters.html">Beamline Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Composite-Driving-Layer.html">Composite Driving Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Configuration.html">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Geometry-Components.html">Geometry Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Glossary.html">Glossary</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="Reflectometry-Troubleshooting-and-FAQ.html">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectometry-bench-configuration.html">Bench Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectometry_blind_script.html">Blind script</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflectometry_blind_script_output.html">Blind script output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Rheometers.html">Rheometers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sample-Changers.html">Sample Changers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sensors.html">Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Signal-Generators.html">Signal Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Temperature-Controllers.html">Temperature Controllers</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Processes &amp; Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Providing-Support.html">Providing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deployment.html">Releases &amp; Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Processes.html">Processes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IBEX Developer's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a></li>
          <li class="breadcrumb-item"><a href="../Reflectometry-IOC.html">Reflectometry</a></li>
      <li class="breadcrumb-item active">Testing</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ISISComputingGroup/ibex_developers_manual/blob/master/doc/specific_iocs/reflectometry/Reflectometry-Testing.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Link to this heading"></a></h1>
<section id="setup-simulated-device">
<h2>SetUp Simulated Device<a class="headerlink" href="#setup-simulated-device" title="Link to this heading"></a></h2>
<p>There are some simulated device setups in the private share <code class="docutils literal notranslate"><span class="pre">...\Reflectometry\configs\&lt;instrument&gt;</span></code>. To use these:</p>
<ol class="arabic simple">
<li><p>Copy galil directory to your configuration directory</p></li>
<li><p>Created a configuration with the correct number of simulated motors</p>
<ul class="simple">
<li><p>some configs have components in that help with that. Your server may need a restart to pick them up after copying them over to your machine</p></li>
</ul>
</li>
<li><p>Switch to config so that the motors are running</p></li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">setup_motors.bat</span></code> in a epics terminal on your machine</p></li>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">config.py</span></code> to your refl directory in your config directory</p></li>
<li><p>Restart the refl ioc</p></li>
</ol>
<p>This should make the instrument act like a simulated version of the chosen instrument.</p>
<p>If you want to swap between multiple configurations you can also create a package (includes <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>) for each instrument and then use the <code class="docutils literal notranslate"><span class="pre">config.py</span></code> in the base directory to swap between them.</p>
</section>
<section id="crisp-in-feb-2019">
<h2>CRISP in Feb 2019.<a class="headerlink" href="#crisp-in-feb-2019" title="Link to this heading"></a></h2>
<section id="setup">
<h3>Setup<a class="headerlink" href="#setup" title="Link to this heading"></a></h3>
<p>Scan in sample and align beam in SECI.</p>
<p>Copy scan.py from LOQ to CRISP to allow in IBEX plotting. Sort out a crisp package and alter the init so that it loads it.</p>
<p><strong>Issue</strong> I can not see how to reload my changed code while developing my scan except to restart the scripting window (which is non-ideal).</p>
<p><strong>Issue</strong> The fitting does not work at the moment so graphs will not display correct fits.</p>
<p><strong>Issue</strong> The errors do not work correctly they are just square root of value</p>
<p>Ideally, this code should be in <code class="docutils literal notranslate"><span class="pre">crisp_inst.py</span></code> but I haven’t put it there yet this is to load in the scanning library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">instrument.crisp.scans</span><span class="w"> </span><span class="kn">import</span> <span class="n">scan</span>
</pre></div>
</div>
</section>
<section id="theta-scan">
<h3>Theta scan<a class="headerlink" href="#theta-scan" title="Link to this heading"></a></h3>
<p>After the final align of the beam you should perform a theta scan to ensure that the beam is aligned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scan</span><span class="p">(</span><span class="s2">&quot;THETA&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">Gaussian</span><span class="p">)</span>
</pre></div>
</div>
<p>which produces <img alt="Theta scan showing a peak at 0.0" src="../../_images/theta_scan.png" />.</p>
</section>
<section id="sample-alignment">
<h3>Sample alignment<a class="headerlink" href="#sample-alignment" title="Link to this heading"></a></h3>
<p>After aligning with the laser:</p>
<ol class="arabic simple">
<li><p>Perform a shadow scan (this is only possible if your sample absorbs/scatters neutrons silicon does not). I could not do this with the sample I has.</p></li>
<li><p>Perform a shallow bounce scan. Set theta to a small angle (0.25) then tilt phi to find the peak in intensity. Start with reasonably wide slits otherwise you will not see anything. NB that the offset in CRISP defined in “Define offsets” is applied before sending it to the motor so when comparing to CRISP don’t forget to manipulate this correctly.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scan(&quot;PHI&quot;,</span> <span class="pre">0.21,</span> <span class="pre">0.285,</span> <span class="pre">count=21,</span> <span class="pre">frames=100,</span> <span class="pre">fit=Gaussian)</span></code></p></li>
<li><p><img alt="Phi scan showing a peak at 0.250" src="../../_images/phi_scan.png" />.</p></li>
<li><p>Move the table to be at the peak of this scan (this should be done by fitting)</p></li>
</ol>
</li>
<li><p>Perform a sample height scan, this should peak at the height and be symmetric.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scan(&quot;HEIGHT&quot;,</span> <span class="pre">0.22,</span> <span class="pre">0.28,</span> <span class="pre">count=21,</span> <span class="pre">frames=200)</span></code></p></li>
<li><p>Move the table to be at the height given by the peak in this scan</p></li>
</ol>
</li>
<li><p>Now repeat until happy that the results are not changing.</p></li>
<li><p>Set the offset so that the user value is 0</p></li>
<li><p>Now perform a phi scan (on CRISP with the silicon block you don’t see anything)</p></li>
</ol>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h2>
<p>Make sure the spectrum 1 look like
Make sure the spectrum 2 look like
Large spike at low time of flight is prompt spike it should not dominate spectra 1 or 3.</p>
<p>Do a theta scan without the sample or super mirror in the way. Does it look correct if not stop and think.</p>
</section>
<section id="crisp-in-march-2019">
<h2>CRISP in March 2019.<a class="headerlink" href="#crisp-in-march-2019" title="Link to this heading"></a></h2>
<p>Did many scans comparing SECI and IBEX see <code class="docutils literal notranslate"><span class="pre">ISIS_Experiment_Controls\Reflectometry\Ticket3462</span></code>.</p>
</section>
<section id="crisp-blind-test">
<h2>CRISP Blind Test<a class="headerlink" href="#crisp-blind-test" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="reflectometry_blind_script.html"><span class="doc std std-doc">Experiment script</span></a></p></li>
<li><p><a class="reference internal" href="reflectometry_blind_script_output.html"><span class="doc std std-doc">Experiment script output</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Reflectometry-Glossary.html" class="btn btn-neutral float-left" title="Glossary" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Reflectometry-Troubleshooting-and-FAQ.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Feb 27, 2026.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>