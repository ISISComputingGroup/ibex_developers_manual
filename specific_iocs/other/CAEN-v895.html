

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CAEN v895 &mdash; IBEX Developer&#39;s Manual</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=e6a88b47" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Catalytic Flow Reactor" href="Catalytic-Flow-Reactor.html" />
    <link rel="prev" title="CAEN Hexagon (MUX Data Acquisition Electronics)" href="CAEN-Hexagon.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >

          
          
          <a href="../../index.html" class="icon icon-home">
            IBEX Developer's Manual
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Editing-the-Wiki.html">Editing this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Interfaces &amp; Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Client.html">IBEX GUI (Eclipse)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Script-Generator.html">Script Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Scripting.html">Scripting (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Web.html">Web Dashboard &amp; Chat</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IBEX Server &amp; Systems</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../System-components.html">Backend System Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../IOCs.html">EPICS IOCs &amp; Support Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Cells.html">Cells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Choppers.html">Choppers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Cryogenics.html">Cryogenics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DAE-and-the-ICP.html">DAE (Data Acquisition Electronics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DAQ.html">DAQ (NI cDAQ)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Fluxgates.html">Fluxgates &amp; Magnetometers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gas-And-Liquid-Handling-Systems.html">Gas and liquid handling systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Imaging-Cameras.html">Imaging Cameras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Loading-Rigs.html">Loading rigs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Magnets.html">Magnets &amp; Large Power Supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Motors.html">Motors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Motors-Extensions.html">Motor Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Multimeters.html">Multimeters</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Other.html">Other / Miscellaneous</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="AnywhereUSB.html">AnywhereUSB</a></li>
<li class="toctree-l3"><a class="reference internal" href="Arduino-RKNDIO-PLC-control.html">Arduino RKNDIO PLC Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="Background-Script-IOC.html">Background Script IOC</a></li>
<li class="toctree-l3"><a class="reference internal" href="CAEN-Hexagon.html">CAEN Hexagon (MUX Data Acquisition Electronics)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">CAEN v895</a></li>
<li class="toctree-l3"><a class="reference internal" href="Catalytic-Flow-Reactor.html">Catalytic Flow Reactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="Coherent-OBIS-Laser-Remote.html">Coherent OBIS Laser Remote</a></li>
<li class="toctree-l3"><a class="reference internal" href="Ferro-Magnetic_Resonance_equipment.html">Ferro-Magnetic Resonance equipment (FMR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Gamry.html">Gamry</a></li>
<li class="toctree-l3"><a class="reference internal" href="Hameg-HM8123.html">Hameg HM8123 programmable counter</a></li>
<li class="toctree-l3"><a class="reference internal" href="Humidity-Controller.html">Humidity Controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="Inhibitor.html">Inhibitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="LOTQD-MSH150-Monochromator.html">LOTQD MSH150 Monochromator</a></li>
<li class="toctree-l3"><a class="reference internal" href="LSi-Correlator.html">LSi Correlator</a></li>
<li class="toctree-l3"><a class="reference internal" href="MOXA-e12XX.html">Moxa e12xx</a></li>
<li class="toctree-l3"><a class="reference internal" href="Ocean-Optics-DH-2000-Shutter-control.html">Ocean Optics DH-2000</a></li>
<li class="toctree-l3"><a class="reference internal" href="RAMAN-Spectrometer.html">RAMAN Spectrometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="Rotating-Stirrer-Rack.html">Rotating Stirrer Rack</a></li>
<li class="toctree-l3"><a class="reference internal" href="SDTest.html">SDTest</a></li>
<li class="toctree-l3"><a class="reference internal" href="SP300-Potentiostat.html">SP300 Potentiostat</a></li>
<li class="toctree-l3"><a class="reference internal" href="Stanford-SR850.html">Stanford SR850 Lock In Amplifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="Thorlabs-FW102C-Filter-Wheel.html">Thorlabs FW102C Filter Wheel</a></li>
<li class="toctree-l3"><a class="reference internal" href="nGEM-detector.html">nGEM Detector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../PLCs.html">PLCs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Polarisers-and-Analysers.html">Polarisers &amp; Analysers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Power-Distribution-Unit-%28PDU%29.html">Power distribution units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Power-Supplies.html">Power supplies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Pressure-Monitors.html">Pressure monitors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reflectometry-IOC.html">Reflectometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Rheometers.html">Rheometers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sample-Changers.html">Sample Changers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sensors.html">Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Signal-Generators.html">Signal Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Temperature-Controllers.html">Temperature Controllers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Systems.html">Systems Administration &amp; Hardware</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Processes &amp; Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Providing-Support.html">Providing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deployment.html">Releases &amp; Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Processes.html">Processes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IBEX Developer's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a></li>
          <li class="breadcrumb-item"><a href="../Other.html">Other / Miscellaneous</a></li>
      <li class="breadcrumb-item active">CAEN v895</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ISISComputingGroup/ibex_developers_manual/blob/master/doc/specific_iocs/other/CAEN-v895.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="caen-v895">
<h1>CAEN v895<a class="headerlink" href="#caen-v895" title="Link to this heading"></a></h1>
<p>This is a VME card used on muons to set discriminator levels. Unfortunately the card has no readbacks, so you can only set it.</p>
<p>The underlying code is an asyn driver communicating via a vendor DLL to set register values. This code is in the EPICS-CAENVME support module. The driver overrides the <code class="docutils literal notranslate"><span class="pre">drvUserCreate</span></code> method so that it can parse an asyn parameter passed from the DB file like <code class="docutils literal notranslate"><span class="pre">VMEWRITE_0x4</span></code> and then split this into a call to a “VMEWRITE” method with an additional value of “0x4” within the asynUser structure.</p>
<p>The ioc is configured using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CAENVMEConfigure(&quot;CRATE0&quot;, 0, 0, 0, 0x10000, $(CAENVMESIM=0)) 
</pre></div>
</div>
<p>0x10000 is a VME base address. Records loaded for a Crate number (CRATE) and card number on crate (C) e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbLoadRecords</span><span class="p">(</span><span class="s2">&quot;$(CAENVME)/db/v895Crate.db&quot;</span><span class="p">,</span><span class="s2">&quot;P=$(MYPVPREFIX),Q=$(IOCNAME):,CRATE=0,PORT=CRATE0&quot;</span><span class="p">)</span>
<span class="n">dbLoadRecords</span><span class="p">(</span><span class="s2">&quot;$(CAENVME)/db/v895Card.db&quot;</span><span class="p">,</span><span class="s2">&quot;P=$(MYPVPREFIX),Q=$(IOCNAME):,CRATE=0,PORT=CRATE0,C=0&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The managing of sets of parameters is done using the epics autosave option called <code class="docutils literal notranslate"><span class="pre">configMenu</span></code> - see notes for recent release of
<a class="reference external" href="http://htmlpreview.github.io/?https://github.com/epics-modules/autosave/blob/master/documentation/autosave.html">http://htmlpreview.github.io/?https://github.com/epics-modules/autosave/blob/master/documentation/autosave.html</a></p>
<p>A configuration called <code class="docutils literal notranslate"><span class="pre">vmeconfig</span></code> is created and enabled</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbLoadRecords</span><span class="p">(</span><span class="s2">&quot;$(AUTOSAVE)/db/configMenu.db&quot;</span><span class="p">,</span><span class="s2">&quot;P=$(MYPVPREFIX)AS:$(IOCNAME):,CONFIG=vmeconfig&quot;</span><span class="p">)</span>
<span class="n">makeAutosaveFileFromDbInfo</span><span class="p">(</span><span class="s2">&quot;vmeconfig_settings.req&quot;</span><span class="p">,</span> <span class="s2">&quot;vmeconfig&quot;</span><span class="p">)</span>
<span class="n">create_manual_set</span><span class="p">(</span><span class="s2">&quot;vmeconfigMenu.req&quot;</span><span class="p">,</span><span class="s2">&quot;P=$(MYPVPREFIX)AS:$(IOCNAME):,CONFIG=vmeconfig,CONFIGMENU=1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then the <code class="docutils literal notranslate"><span class="pre">defaults</span></code> config is applied</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dbpf</span><span class="p">(</span><span class="s2">&quot;$(MYPVPREFIX)AS:$(IOCNAME):vmeconfigMenu:name&quot;</span><span class="p">,</span> <span class="s2">&quot;defaults&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As noted above a simulation mode can be enabled by setting the <code class="docutils literal notranslate"><span class="pre">CAENVMESIM</span></code> macro to 1</p>
<p>configMenu lets you dynamically load and save autosaved values by writing to PVs. If you look in the DB files for cards you will see</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">info</span><span class="p">(</span><span class="n">vmeconfig</span><span class="p">,</span> <span class="s2">&quot;VAL&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This means the VAL field of that record is part of the <code class="docutils literal notranslate"><span class="pre">vmeconfig</span></code> config menu set. Calling <code class="docutils literal notranslate"><span class="pre">makeAutosaveFileFromDbInfo</span></code> will create <code class="docutils literal notranslate"><span class="pre">vmeconfig_settings.req</span></code> at ioc start and then <code class="docutils literal notranslate"><span class="pre">create_manual_set</span></code> create the autosave set to manage the pvs (vmeconfigMenu.req references <code class="docutils literal notranslate"><span class="pre">vmeconfig_settings.req</span></code>). The OPI for the v895 loads the <code class="docutils literal notranslate"><span class="pre">configMenu.opi</span></code> supplied with autosave which allows different sets of PVS to be loaded and saved, however in practice they just load the first one called <code class="docutils literal notranslate"><span class="pre">defaults</span></code> as done by <code class="docutils literal notranslate"><span class="pre">dbpf</span></code> in the <code class="docutils literal notranslate"><span class="pre">st.cmd</span></code></p>
<p>configMenu docs: <a class="reference external" href="https://epics.anl.gov/bcda/synApps/autosave/autoSaveRestore_R5-6-1.html#configMenu">https://epics.anl.gov/bcda/synApps/autosave/autoSaveRestore_R5-6-1.html#configMenu</a></p>
<section id="sending-settings">
<h2>Sending settings<a class="headerlink" href="#sending-settings" title="Link to this heading"></a></h2>
<p>It should be noted that a channel does not have to be disabled for the setting to be sent and applied, e.g. a threshold.</p>
</section>
<section id="applying-defaults-on-startup">
<h2>Applying defaults on startup<a class="headerlink" href="#applying-defaults-on-startup" title="Link to this heading"></a></h2>
<p>If a config menu set called <code class="docutils literal notranslate"><span class="pre">defaults</span></code> is present, then these values are automatically applied at startup. It is possible to create other named sets to save and restore. You can check if these boot time defaults are present by:</p>
<ul class="simple">
<li><p>Go into the <code class="docutils literal notranslate"><span class="pre">Load</span> <span class="pre">and</span> <span class="pre">save</span> <span class="pre">settings...</span></code> screen</p></li>
<li><p>Check these is a set named <code class="docutils literal notranslate"><span class="pre">defaults</span></code> listed as the first line</p></li>
<li><p>If there isn’t, type in the name <code class="docutils literal notranslate"><span class="pre">defaults</span></code> and if all the threshold values on the other screen are correct press <code class="docutils literal notranslate"><span class="pre">save</span></code></p></li>
<li><p>this will create a <code class="docutils literal notranslate"><span class="pre">vmeconfig_defaults.sav</span></code> snapshot file in the autosave area for <code class="docutils literal notranslate"><span class="pre">CAENVME_01</span></code> IOC to use on restart</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CAEN-Hexagon.html" class="btn btn-neutral float-left" title="CAEN Hexagon (MUX Data Acquisition Electronics)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Catalytic-Flow-Reactor.html" class="btn btn-neutral float-right" title="Catalytic Flow Reactor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Oct 31, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>