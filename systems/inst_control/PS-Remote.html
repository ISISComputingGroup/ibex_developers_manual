

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Powershell Remote &mdash; IBEX Developer&#39;s Manual</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=e6a88b47" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rebuild Performance Counters" href="Rebuild-Performance-Counters.html" />
    <link rel="prev" title="Building a new instrument virtual machine from MDT" href="mdt/Building-a-windows-10-instrument-machine-from-MDT.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >

          
          
          <a href="../../index.html" class="icon icon-home">
            IBEX Developer's Manual
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Editing-the-Wiki.html">Editing this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Interfaces &amp; Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Client.html">IBEX GUI (Eclipse)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Script-Generator.html">Script Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Scripting.html">Scripting (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Web.html">Web Dashboard &amp; Chat</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IBEX Server &amp; Systems</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../System-components.html">Backend System Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../IOCs.html">EPICS IOCs &amp; Support Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Systems.html">Systems Administration &amp; Hardware</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../External.html">External systems/services</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Inst-Control.html">Instrument control computers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Archive-Watcher.html">Archive Watcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="Automated-log-rotation.html">Automated log rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Change-Windows-Theme.html">Change Windows Theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="Computer-Troubleshooting.html">Computer Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="Data-Generation-and-Storage-on-Instrument-PCs-%28NDX%27s%29.html">Data Storage &amp; Production</a></li>
<li class="toctree-l3"><a class="reference internal" href="Increase-VM-memory.html">Increase VM memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="MDT-%28Microsoft-deployment-toolkit%29.html">MDT (Microsoft deployment toolkit)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Powershell Remote</a></li>
<li class="toctree-l3"><a class="reference internal" href="Rebuild-Performance-Counters.html">Rebuild Performance Counters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Script-to-connect-to-all-instruments.html">Script to connect to all instruments</a></li>
<li class="toctree-l3"><a class="reference internal" href="TreeSize-Pro.html">TreeSize</a></li>
<li class="toctree-l3"><a class="reference internal" href="VM-VHD-replication.html">VM VHD Replication</a></li>
<li class="toctree-l3"><a class="reference internal" href="cron-jobs-and-windows-scheduled-tasks.html">Cron Jobs &amp; Scheduled Tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../MinimumSpecs.html">Minimum machine specifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Nagios.html">Nagios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Shadow.html">Shadow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Sparrowhawk.html">Sparrowhawk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Test-Machines.html">Test Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Webserver.html">Webserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../control-svcs.html"><code class="docutils literal notranslate"><span class="pre">control-svcs</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Processes &amp; Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Providing-Support.html">Providing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deployment.html">Releases &amp; Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Processes.html">Processes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IBEX Developer's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../Systems.html">Systems Administration &amp; Hardware</a></li>
          <li class="breadcrumb-item"><a href="../Inst-Control.html">Instrument control computers</a></li>
      <li class="breadcrumb-item active">Powershell Remote</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ISISComputingGroup/ibex_developers_manual/blob/master/doc/systems/inst_control/PS-Remote.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="powershell-remote">
<h1>Powershell Remote<a class="headerlink" href="#powershell-remote" title="Link to this heading"></a></h1>
<p>Remote Powershell can be used on the NDX machines to run arbitrary command line scripts remotely. This could be useful for example if you want to run something as the database admin without having to interrupt instruments running.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is obviously very dangerous - you will have the power to run any commands and could affect the running instrument quite severely.**</p>
</div>
<section id="how-to-set-your-machine-up">
<h2>How to set your machine up<a class="headerlink" href="#how-to-set-your-machine-up" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Start a PowerShell terminal as administrator (found under <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">PowerShell</span></code> in the Start Menu)</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">Enable-PSRemoting</span></code> you should see an output like:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WinRM</span> <span class="n">has</span> <span class="n">been</span> <span class="n">updated</span> <span class="n">to</span> <span class="n">receive</span> <span class="n">requests</span><span class="o">.</span>
<span class="n">WinRM</span> <span class="n">service</span> <span class="nb">type</span> <span class="n">changed</span> <span class="n">successfully</span><span class="o">.</span>
<span class="n">WinRM</span> <span class="n">service</span> <span class="n">started</span><span class="o">.</span>

<span class="n">WinRM</span> <span class="n">has</span> <span class="n">been</span> <span class="n">updated</span> <span class="k">for</span> <span class="n">remote</span> <span class="n">management</span><span class="o">.</span>
<span class="n">WinRM</span> <span class="n">firewall</span> <span class="n">exception</span> <span class="n">enabled</span><span class="o">.</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">Set-Item</span> <span class="pre">-Path</span> <span class="pre">WSMan:\localhost\Client\TrustedHosts</span> <span class="pre">-Value</span> <span class="pre">*</span> <span class="pre">-Force</span></code>.  This will allow your machine to access others.</p></li>
</ol>
</section>
<section id="using-powershell-remote">
<h2>Using Powershell Remote<a class="headerlink" href="#using-powershell-remote" title="Link to this heading"></a></h2>
<p>Once the above setup has been done you can use PowerShell Remote as follows:</p>
<ol class="arabic simple">
<li><p>Start a PowerShell terminal (does not need to be admin).</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">$cred=get-credential</span></code> and you will see a pop up box asking for you to input some credentials.</p></li>
<li><p>Input the credentials for an instrument admin account (remember to put in an instrument machine as the domain but this can be any instrument machine, the credentials will still work for remote access as long as the machine has the same administrator account).</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">Invoke-Command</span> <span class="pre">-Credential</span> <span class="pre">$cred</span>&#160; <span class="pre">instrument_machine</span> <span class="pre">{</span> <span class="pre">command</span> <span class="pre">}</span></code>, where <em><code class="docutils literal notranslate"><span class="pre">command</span></code></em> is the PowerShell command or script you’d like to run on the remote <em><code class="docutils literal notranslate"><span class="pre">instrument-machine</span></code></em> (standard DOS commands can be executed with <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">cmd</span> <span class="pre">/c</span></code> <em><code class="docutils literal notranslate"><span class="pre">command</span></code></em> }).</p></li>
</ol>
</section>
<section id="accessing-lots-of-instruments">
<h2>Accessing lots of instruments<a class="headerlink" href="#accessing-lots-of-instruments" title="Link to this heading"></a></h2>
<p>There are some useful power shell scripts in the isis private share <code class="docutils literal notranslate"><span class="pre">...private_git_repositories\private_scripts.git</span></code> including one that helps remote to instrument machines and run the same command.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mdt/Building-a-windows-10-instrument-machine-from-MDT.html" class="btn btn-neutral float-left" title="Building a new instrument virtual machine from MDT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Rebuild-Performance-Counters.html" class="btn btn-neutral float-right" title="Rebuild Performance Counters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Oct 31, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>