

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>General troubleshooting &mdash; IBEX Developer&#39;s Manual</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=e6a88b47" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="IOC Startup Example" href="IOC-Start-Example.html" />
    <link rel="prev" title="DLL Dependency Walker" href="Dependency-Walker.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >

          
          
          <a href="../../index.html" class="icon icon-home">
            IBEX Developer's Manual
              <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Overview.html">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Editing-the-Wiki.html">Editing this Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Interfaces &amp; Scripting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Client.html">IBEX GUI (Eclipse)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Script-Generator.html">Script Generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Scripting.html">Scripting (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Web.html">Web Dashboard &amp; Chat</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IBEX Server &amp; Systems</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../System-components.html">Backend System Components</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../IOCs.html">EPICS IOCs &amp; Support Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Compiling.html">Compiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Conventions.html">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Creation.html">IOC Creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Testing.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tips-and-Tricks.html">Tips, Tricks &amp; Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tools.html">Tools &amp; Support Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Troubleshooting.html">Troubleshooting</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ASYN-Trace-Masks-%28Debugging-IOC%2C-ASYN%29.html">Asyn Trace Masks</a></li>
<li class="toctree-l3"><a class="reference internal" href="Dependency-Walker.html">DLL Dependency Walker</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">General troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="IOC-Start-Example.html">IOC Startup Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="IOC-Start-Example.html#full-log">Full Log</a></li>
<li class="toctree-l3"><a class="reference internal" href="IOC-crash-or-unexpected-termination-%E2%80%90-Find-function-from-windows-module-offset.html">IOC Crash - find function from offset</a></li>
<li class="toctree-l3"><a class="reference internal" href="IOC-flow-control-settings.html">IOC Flow Control Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="Log-file-location.html">Log file locations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Remote-Debugging-from-Visual-Studio.html">Remote Debugging from Visual Studio</a></li>
<li class="toctree-l3"><a class="reference internal" href="Serial-Bruteforce-script.html">Serial Bruteforce Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="Serial-Port-Debug.html">Serial Port Debug</a></li>
<li class="toctree-l3"><a class="reference internal" href="TestSerialPort.html">TestSerialPort</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Specific-IOCs.html">Specific Devices &amp; IOCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Systems.html">Systems Administration &amp; Hardware</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Processes &amp; Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Providing-Support.html">Providing Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Deployment.html">Releases &amp; Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Processes.html">Processes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #343131" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IBEX Developer's Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../IOCs.html">EPICS IOCs &amp; Support Modules</a></li>
          <li class="breadcrumb-item"><a href="../Troubleshooting.html">Troubleshooting</a></li>
      <li class="breadcrumb-item active">General troubleshooting</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ISISComputingGroup/ibex_developers_manual/blob/master/doc/iocs/troubleshooting/IOC-And-Device-Trouble-Shooting.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="general-troubleshooting">
<h1>General troubleshooting<a class="headerlink" href="#general-troubleshooting" title="Link to this heading"></a></h1>
<p><strong>After diagnosing the problem</strong> If you needed to go down to the instrument please correct/update any connection information to <a class="reference internal" href="../../Specific-IOCs.html"><span class="doc std std-doc">Specific Device IOC page</span></a>.</p>
<section id="my-ioc-does-not-show-up-in-the-ioc-list-in-ibex">
<h2>My IOC does not show up in the IOC list in IBEX<a class="headerlink" href="#my-ioc-does-not-show-up-in-the-ioc-list-in-ibex" title="Link to this heading"></a></h2>
<p>To update the list of IOCs in IBEX (which is stored in the database) you will need to run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">iocstartups</span></code> from <code class="docutils literal notranslate"><span class="pre">C:\Instrument\Apps\EPICS\</span></code> - this will concatenate all the <code class="docutils literal notranslate"><span class="pre">config.xml</span></code> files in the <code class="docutils literal notranslate"><span class="pre">ioc</span></code> directory for each IOC, then filter it and push it to the database.</p>
</section>
<section id="my-ioc-fails-to-make-with-permission-denied">
<h2>My IOC fails to make with “Permission Denied”<a class="headerlink" href="#my-ioc-fails-to-make-with-permission-denied" title="Link to this heading"></a></h2>
<p>This is likely not to do with permissions but that the file is in use elsewhere. Try running stop_ibex_server.bat and if that doesn’t work find out what else may be using the file (<a class="reference external" href="https://lockhunter.com/">LockHunter</a> is quite useful).</p>
</section>
<section id="my-ioc-fails-to-build-with-epics-base-master-configure-rules-db-201-target-pattern-contains-no">
<h2>My IOC fails to build with <code class="docutils literal notranslate"><span class="pre">epics/base/master/configure/RULES.Db:201:</span> <span class="pre">***</span> <span class="pre">target</span> <span class="pre">pattern</span> <span class="pre">contains</span> <span class="pre">no</span> <span class="pre">'%'</span></code><a class="headerlink" href="#my-ioc-fails-to-build-with-epics-base-master-configure-rules-db-201-target-pattern-contains-no" title="Link to this heading"></a></h2>
<p>This could be caused by the IOC attempting to copy in invalid db files during the build check in <code class="docutils literal notranslate"><span class="pre">XXIOC-01App/Db/Makefile</span></code> that any dbs listed there exist.</p>
</section>
<section id="i-am-having-an-issue-with-a-specific-ioc">
<h2>I am having an Issue with a Specific IOC<a class="headerlink" href="#i-am-having-an-issue-with-a-specific-ioc" title="Link to this heading"></a></h2>
<p>Some IOC have important details which may help see if it is listed in <a class="reference internal" href="../../Specific-IOCs.html"><span class="doc std std-doc">Specific Device IOC</span></a>.</p>
</section>
<section id="checking-stream-device-asyn-serial-port-settings">
<h2>checking stream device/asyn serial port settings<a class="headerlink" href="#checking-stream-device-asyn-serial-port-settings" title="Link to this heading"></a></h2>
<p>At the IOC command prompt, type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dbior(&quot;drvAsyn&quot;,2)
</pre></div>
</div>
</section>
<section id="ioc-fails-to-connect-to-serial-com-port">
<h2>ioc fails to connect to serial COM port<a class="headerlink" href="#ioc-fails-to-connect-to-serial-com-port" title="Link to this heading"></a></h2>
<p>Errors like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2022</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">29</span> <span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mf">08.570</span> <span class="n">L0</span> <span class="o">-</span><span class="mi">1</span> <span class="n">autoConnect</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">connect</span><span class="p">:</span> \\<span class="o">.</span>\<span class="n">COM106</span> <span class="n">Can</span><span class="s1">&#39;t open: Access is denied.</span>
</pre></div>
</div>
<p><em>access is denied</em> probably means another process (an IOC or terminal emulator like hyperterm) is already using the port. After you stop the offending process, it may be a few seconds before you can connect.</p>
</section>
<section id="it-doesn-t-work-what-should-i-do">
<h2>It doesn’t work What Should I Do?<a class="headerlink" href="#it-doesn-t-work-what-should-i-do" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Connect over hyperterminal (see <em>Connect over hyperterminal</em>)</p></li>
<li><p>Check command set is correct (look at documentation)</p></li>
<li><p>Start the IOC and check it is not in SIM mode</p></li>
<li><p>Set the IOC mask (see <em>What is Passing between the IOC and the <em>Stream</em> Device</em>)</p></li>
<li><p>If you don’t think records are processing correctly, try setting the <code class="docutils literal notranslate"><span class="pre">TPRO</span></code> (trace processing) field of the relevant records to a non-zero value. This will print a message to the IOC log whenever the record processes.</p></li>
</ol>
</section>
<section id="any-write-to-the-pv-fails">
<h2>Any write to the PV fails<a class="headerlink" href="#any-write-to-the-pv-fails" title="Link to this heading"></a></h2>
<p>If any caput command to a pv fails with a message similar to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Old : TE:NDW1801:ICEFRDGE_01:MIMIC:SKIP:SP SKIP0
New : CA.Client.Exception..................................TE:NDW1801:ICEFRDGE_01:MIMIC:SKIP.:SP. .SKIP0.
.........
    Warning: &quot;Channel write request failed&quot;
    Context: &quot;op=1, channel=TE:NDW1801:ICEFRDGE_01:MIMIC:SKIP:SP, type=DBR_STRING, count=1, ctx=&quot;TE:NDW1801:ICEFRDGE_01:MIMIC:SKIP:SP&quot;&quot;
    Source File: ../oldChannelNotify.cpp line 160
    Current Time: Tue Nov 19 2019 09:56:21.490881300
...............................................................…
</pre></div>
</div>
<p>Then you may want to check if said PV is disabled somewhere in your db file through its DISP field by another PV.</p>
</section>
<section id="connect-over-hyperterminal">
<h2>Connect over hyperterminal<a class="headerlink" href="#connect-over-hyperterminal" title="Link to this heading"></a></h2>
<p>Start hyper-terminal set up connection to device. Find a command that is returns something or that changes something on the display. Run that command look for the change. Try</p>
<ol class="arabic simple">
<li><p>Reading</p></li>
<li><p>Writing</p></li>
</ol>
<p>If it doesn’t work check:</p>
<ol class="arabic simple">
<li><p>Protocol (RS232, RS422, RS482)</p></li>
<li><p>Baud Rate</p></li>
<li><p>Com Port</p></li>
<li><p>Stop Bits</p></li>
<li><p>Parity</p></li>
<li><p>Line ending/Termination characters.</p></li>
<li><p>Flow control</p></li>
</ol>
<p>If this doesn’t work check the moxa logging (see data over the moxa connection). If this doesn’t work there is a device that can be plugged into a serial port to intercept all traffic.</p>
</section>
<section id="it-won-t-work-in-the-ioc-initially-but-with-no-changes-works-after-connecting-to-hyperterminal">
<h2>It won’t work in the IOC initially, but with no changes works after connecting to hyperterminal<a class="headerlink" href="#it-won-t-work-in-the-ioc-initially-but-with-no-changes-works-after-connecting-to-hyperterminal" title="Link to this heading"></a></h2>
<p>If the IOC doesn’t work on startup, but does after using hyperterminal, at a command prompt run a <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">com1</span></code> on the appropriate com port (example is for COM1) before and after running hyperterminal. If there is a change that isn’t duplicated by starting the IOC, then there is possibly a setting missing in asyn.</p>
</section>
<section id="it-did-work-and-then-freezes">
<h2>It did work and then freezes<a class="headerlink" href="#it-did-work-and-then-freezes" title="Link to this heading"></a></h2>
<p>This may be due to a low control issue e.g. <code class="docutils literal notranslate"><span class="pre">Xon</span></code>/<code class="docutils literal notranslate"><span class="pre">Xoff</span></code> has been incorrectly specified and some binary character
happens to match <code class="docutils literal notranslate"><span class="pre">Xoff</span></code>. You should see asyn still sending character when you enable trace, but non getting through. If you run the <code class="docutils literal notranslate"><span class="pre">dbior</span></code> command at level 2 you may see <code class="docutils literal notranslate"><span class="pre">waiting</span> <span class="pre">as</span> <span class="pre">seen</span> <span class="pre">Xoff</span></code>.</p>
</section>
<section id="the-device-is-sensitive-to-input-commands">
<h2>The device is sensitive to input commands<a class="headerlink" href="#the-device-is-sensitive-to-input-commands" title="Link to this heading"></a></h2>
<p>Some devices has sensitivity to the rate at which you poll them. Typically the devices manual will detail appropriate command spacing, and the ability to use <code class="docutils literal notranslate"><span class="pre">wait</span> <span class="pre">[time</span> <span class="pre">in</span> <span class="pre">ms];</span></code> after <code class="docutils literal notranslate"><span class="pre">in</span></code> or <code class="docutils literal notranslate"><span class="pre">out</span></code> commands in the protocol file is available. However, it is important to ensure your records and their types and error handling have been correctly defined. For instance in the event of a type error, since this is handled outside of the protocol file, it will bypass any structures you have in place to slow polling rates.</p>
</section>
<section id="what-is-passing-between-the-ioc-and-the-stream-device">
<h2>What is Passing between the IOC and the <em>Stream</em> Device<a class="headerlink" href="#what-is-passing-between-the-ioc-and-the-stream-device" title="Link to this heading"></a></h2>
<p>It is possible to put stream into a debug mode where everything sent and received is written to the console. To do this simply add to you st.cmd file (defined on your asyn port) :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asynSetTraceMask</span><span class="p">(</span><span class="s2">&quot;L0&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x9</span><span class="p">)</span> 
<span class="n">asynSetTraceIOMask</span><span class="p">(</span><span class="s2">&quot;L0&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x2</span><span class="p">)</span>
</pre></div>
</div>
<p>where <port> is the port name you used in the asyn setup e.g. <code class="docutils literal notranslate"><span class="pre">drvAsynSerialPortConfigure(&lt;port&gt;...)</span></code></p>
<p>This will include the terminator character, if you don’t see it it is not being sent or received.
If no reply is given this will include a message “No reply from device in XXXms”</p>
<p>See <a class="reference internal" href="ASYN-Trace-Masks-%28Debugging-IOC%2C-ASYN%29.html"><span class="doc std std-doc">Asyn trace mask</span></a> for more details on specifying trace masks</p>
<p>To stop printing these commands to the log use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asynSetTraceMask</span><span class="p">(</span><span class="s2">&quot;L0&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x0</span><span class="p">)</span> 
<span class="n">asynSetTraceIOMask</span><span class="p">(</span><span class="s2">&quot;L0&quot;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="is-the-moxa-seeing-anything">
<h2>Is the MOXA seeing anything?<a class="headerlink" href="#is-the-moxa-seeing-anything" title="Link to this heading"></a></h2>
<p>It is sometime useful to see if the moxa is seeing any traffic. If you are in the cabin you can look at the flashing lights (remember to take away 4 to convert from com number to port number). There is one light for send and one for receive both should flash.</p>
<p>If you want to do it remotely then you can by using the moxa web page. The address is on the <a class="reference external" href="https://varanus.isis.cclrc.ac.uk/nagios/">nagios page (standard log on)</a>. Look at Hosts -&gt; MOXA_<Instrument name> the IP address is at top of the page in the middle. Enter the IP in a web browser and enter password from password page.
Then Monitor -&gt; Asyn shows received and sent byte count.</p>
</section>
<section id="environment-variable-not-getting-set-from-master-release">
<h2>Environment Variable not getting set from MASTER_RELEASE<a class="headerlink" href="#environment-variable-not-getting-set-from-master-release" title="Link to this heading"></a></h2>
<p>Variables are transferred from <code class="docutils literal notranslate"><span class="pre">...EPICS\configure\MASTER_RELEASE</span></code> to <code class="docutils literal notranslate"><span class="pre">...EPICS\ioc\master\&lt;IOCNAME&gt;\iocBoot\&lt;IOCNAME&gt;\envPaths</span></code> when the ioc is made. You will have to delete the file to get the newest macros in and the paths have to exist.</p>
</section>
<section id="i-get-a-udf-alarm-on-by-bi-record-that-s-getting-its-value-from-a-calcout">
<h2>I get a <code class="docutils literal notranslate"><span class="pre">UDF</span></code> alarm on by <code class="docutils literal notranslate"><span class="pre">bi</span></code> record that’s getting its value from a <code class="docutils literal notranslate"><span class="pre">calcout</span></code><a class="headerlink" href="#i-get-a-udf-alarm-on-by-bi-record-that-s-getting-its-value-from-a-calcout" title="Link to this heading"></a></h2>
<p>This was observed whilst programming the GEMORC IOC. We had records like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">record</span><span class="p">(</span><span class="n">calc</span><span class="p">,</span> <span class="s2">&quot;$(P)CALC&quot;</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">field</span><span class="p">(</span><span class="n">INPA</span><span class="p">,</span> <span class="s2">&quot;$(P)LONGIN1&quot;</span><span class="p">)</span>
	<span class="n">field</span><span class="p">(</span><span class="n">INPB</span><span class="p">,</span> <span class="s2">&quot;$(P)LONGIN2&quot;</span><span class="p">)</span>
	<span class="n">field</span><span class="p">(</span><span class="n">CALC</span><span class="p">,</span> <span class="s2">&quot;A+B==0&quot;</span><span class="p">)</span>	
	<span class="n">field</span><span class="p">(</span><span class="n">OUT</span><span class="p">,</span> <span class="s2">&quot;$(P)BI&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">record</span><span class="p">(</span><span class="n">bi</span><span class="p">,</span> <span class="s2">&quot;$(P)BI&quot;</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">field</span><span class="p">(</span><span class="n">ZNAM</span><span class="p">,</span> <span class="s2">&quot;No&quot;</span><span class="p">)</span>
	<span class="n">field</span><span class="p">(</span><span class="n">ONAM</span><span class="p">,</span> <span class="s2">&quot;Yes&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The result was a <code class="docutils literal notranslate"><span class="pre">UDF</span></code> alarm on the <code class="docutils literal notranslate"><span class="pre">bi</span></code> because the <code class="docutils literal notranslate"><span class="pre">RVAL</span></code> wasn’t being updated in line with the <code class="docutils literal notranslate"><span class="pre">VAL</span></code>. We tried a lot of things to sort this. In the end we changed the <code class="docutils literal notranslate"><span class="pre">OUT</span></code> field of the <code class="docutils literal notranslate"><span class="pre">CALC</span></code> to a <code class="docutils literal notranslate"><span class="pre">FLNK</span></code> and added the following field to the <code class="docutils literal notranslate"><span class="pre">bi</span></code>: <code class="docutils literal notranslate"><span class="pre">field(INP,</span> <span class="pre">&quot;$(P)CALC&quot;)</span></code>. We don’t know why this solution worked over the many others we tried.</p>
</section>
<section id="ioc-crashes-on-debug-the-exception-in-unhandled-exception-at-stack-cookie-instrumentation-code-detected-a-stack-based-buffer-overrun">
<h2>IOC Crashes on debug the exception in “Unhandled exception at … : Stack cookie instrumentation code detected a stack-based buffer overrun.”<a class="headerlink" href="#ioc-crashes-on-debug-the-exception-in-unhandled-exception-at-stack-cookie-instrumentation-code-detected-a-stack-based-buffer-overrun" title="Link to this heading"></a></h2>
<p>This is caused when something bad happens to the stack. There are many underlying causes to this, in my case it was that the IOC had loaded a dll which used an incorrect version of visual studio in its build see <a class="reference external" href="https://docs.microsoft.com/en-us/cpp/c-runtime-library/potential-errors-passing-crt-objects-across-dll-boundaries?view=msvc-160">here</a>. The dlls that are loaded (with their paths) can be seen in debug -&gt; Windows -&gt; Modules in VS. To check if it is this error delete the offending dll and try the process again. To fix the error convert the IOC to use build dependencies instead of the master release list, instructions are in <a class="reference internal" href="../compiling/Reducing-Build-Dependencies.html"><span class="doc std std-doc">Reducing Build Dependencies</span></a></p>
<p>In some cases you may be using a vendor DLL and have no control over which version of VS it is built with. If this is the case you may get an access violation when freeing memory allocated by the DLL. The easiest way round this if there is no way to rebuild the DLL is just to take the memory hit of not freeing the resource.</p>
</section>
<section id="log-shows-currenttime-getcurrenttime-xxx-sec-time-discontinuity-detected">
<h2>Log shows <code class="docutils literal notranslate"><span class="pre">currentTime::getCurrentTime():</span> <span class="pre">XXX</span> <span class="pre">sec</span> <span class="pre">time</span> <span class="pre">discontinuity</span> <span class="pre">detected</span></code><a class="headerlink" href="#log-shows-currenttime-getcurrenttime-xxx-sec-time-discontinuity-detected" title="Link to this heading"></a></h2>
<p>The log for all IOCs shows the message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">currentTime</span><span class="p">::</span><span class="n">getCurrentTime</span><span class="p">():</span> <span class="n">XXX</span> <span class="n">sec</span> <span class="n">time</span> <span class="n">discontinuity</span> <span class="n">detected</span>
</pre></div>
</div>
<p>It is caused by the time going backwards due to a correction; the underlying cause is unknown. However, this seems to disappear once the host machine is restarted.</p>
</section>
<section id="my-ioc-is-not-starting-reacting-at-all-when-launching-from-console-procserv">
<h2>My IOC is not starting/reacting at all when launching from console/ProcServ<a class="headerlink" href="#my-ioc-is-not-starting-reacting-at-all-when-launching-from-console-procserv" title="Link to this heading"></a></h2>
<p>If your IOC running in procserv is unresponsive (does not start up, <code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">+</span> <span class="pre">x</span></code> from console does nothing) but you can still start the IOC manually from the IOCBoot directory, it is possible another process is using the port allocated to this IOC by procserv.</p>
<ol class="arabic simple">
<li><p>You can find the port procserv is trying to use for a given IOC under <code class="docutils literal notranslate"><span class="pre">EPICS\iocstartup\procserv.bat</span></code></p></li>
<li><p>In a command window, type <code class="docutils literal notranslate"><span class="pre">netstat</span> <span class="pre">-ano</span></code>. This gives you a list of ports currently in use and the IDs of processes using them</p></li>
<li><p>Search that list for the port from step 1. This will give you the ID of the process using it.</p></li>
<li><p>Find the process by it’s ID in task manager.</p></li>
</ol>
</section>
<section id="asyn-reports-an-asynstatus-value-of-greater-than-5">
<h2>Asyn reports an <code class="docutils literal notranslate"><span class="pre">asynStatus</span></code> value of greater than 5<a class="headerlink" href="#asyn-reports-an-asynstatus-value-of-greater-than-5" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">asynStatus</span></code> enum only contains values 0 to 5. But these are extended in <code class="docutils literal notranslate"><span class="pre">asyn/asynPortDriver/paramErrors.h</span></code> to include a few more useful statuses.</p>
</section>
<section id="autosave">
<h2>Autosave<a class="headerlink" href="#autosave" title="Link to this heading"></a></h2>
<section id="lost-autosave-values-especially-on-galils">
<h3>Lost autosave values (especially on Galils)<a class="headerlink" href="#lost-autosave-values-especially-on-galils" title="Link to this heading"></a></h3>
<p>This is based on ticket: <a class="reference external" href="https://github.com/ISISComputingGroup/IBEX/issues/2180">https://github.com/ISISComputingGroup/IBEX/issues/2180</a></p>
<p>Possible symptoms include:</p>
<ul class="simple">
<li><p>Autosaved values mysteriously changing when the IOC is restarted</p>
<ul>
<li><p>This includes Galils not retaining their position</p></li>
</ul>
</li>
<li><p>Errors of the form <code class="docutils literal notranslate"><span class="pre">[DATE]</span> <span class="pre">dbFindRecord</span> <span class="pre">for</span> <span class="pre">'MY_PV.FIELD'</span> <span class="pre">failed</span></code></p></li>
<li><p>Autosave files containing just a header and <code class="docutils literal notranslate"><span class="pre">&lt;END&gt;</span></code> tag</p></li>
</ul>
<p>This has been observed primarily on Galils since they create custom monitor sets but it is feasible the issue could be seen elsewhere. The Galils pass macros to their monitor sets. If no macros are passed (e.g. if <code class="docutils literal notranslate"><span class="pre">GALILADDR0n</span></code> is not set) then no monitor will be created and no values will be saved. This will mean the device (e.g. the motor) will start with its default values. If the macro is reintroduced then those default values will become the new autosave values. The previous values can be recovered by restoring a previous autosave file (e.g. copy <code class="docutils literal notranslate"><span class="pre">GALIL_02_settings.sav_170309-144116</span></code> to <code class="docutils literal notranslate"><span class="pre">GALIL_02_settings.sav</span></code> and restart the IOC).</p>
<p>Galils also will not autosave any settings or values if they are set to <code class="docutils literal notranslate"><span class="pre">DEVSIM</span></code> or <code class="docutils literal notranslate"><span class="pre">RECSIM</span></code> mode.</p>
</section>
<section id="comparing-current-to-previous-autosaved-values">
<h3>comparing current to previous autosaved values<a class="headerlink" href="#comparing-current-to-previous-autosaved-values" title="Link to this heading"></a></h3>
<p>When an IOC starts, it copies the last autosave values to a date stamped file such as <code class="docutils literal notranslate"><span class="pre">GALIL_02_settings.sav_170309-144116</span></code> You can compare the current running IOC values to any of these files by using the <code class="docutils literal notranslate"><span class="pre">asVerify</span></code> command that is built as part of the <code class="docutils literal notranslate"><span class="pre">autosave</span></code> module and should be in your path after a <code class="docutils literal notranslate"><span class="pre">config_env</span></code> e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asVerify</span>  <span class="n">C</span><span class="p">:</span>\<span class="n">Instrument</span>\<span class="n">Var</span>\<span class="n">autosave</span>\<span class="n">GALIL_02</span>\<span class="n">GALIL_02_settings</span><span class="o">.</span><span class="n">sav_170309</span><span class="o">-</span><span class="mi">144116</span>
</pre></div>
</div>
<p>There is no command to apply an autosave file to the current PVS, this is because it may be a bit dangerous as boot time autosave can apply values without forcing a process of a PV, whereas using a <code class="docutils literal notranslate"><span class="pre">caput</span></code> could have different results. Thus it is better to stop ioc, update autosave file, start ioc as described for galil above.</p>
</section>
</section>
<section id="motors">
<h2>Motors<a class="headerlink" href="#motors" title="Link to this heading"></a></h2>
<section id="limit-switches-not-active-at-the-limit-position">
<h3>Limit switches not active at the limit position<a class="headerlink" href="#limit-switches-not-active-at-the-limit-position" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://github.com/ISISComputingGroup/IBEX/issues/2174">https://github.com/ISISComputingGroup/IBEX/issues/2174</a></p>
<p>In the motor record (<code class="docutils literal notranslate"><span class="pre">C:\Instrument\Apps\EPICS\support\motor\master\motorApp\MotorSrc\motorRecord.cc</span></code>) the limit flag is only activated if the motor’s limit switch bit is active and motor’s command direction (CDIR) is correct. Correct in this context means that the motor is moving out of range. That is, the motor is moving in a positive direction past an upper limit or in a negative direction past the lower limit. The command direction is only set when a command (e.g. home, move) is sent. If the IOC is restarted, the value isn’t saved (and cannot be auto saved) so the limit flag behaviour will depend on the initial value of the command direction.</p>
<p>In summary, being at the limit position is insufficient to cause the limit flag to be active. This is expected behaviour, though can be slightly unintuitive at first.</p>
</section>
<section id="readbacks-from-device-keep-twitching">
<h3>Readbacks from device keep twitching<a class="headerlink" href="#readbacks-from-device-keep-twitching" title="Link to this heading"></a></h3>
<p>This may be because of variances in the signal returned from the motor. This is true, for example, on the jaws set on Merlin. It also causes the motor status label on the bumpstrip to keep switching. Note that leaving it in this state can increase dramatically the amount of information sent to the archiver.</p>
<p>To fix, use caput for the relevant PV in the motor record:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IN:[INST]:MOT:MTR0n0m.MDEL</span></code>: Sets the motor deadband. This will stop the position readback from oscillating</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IN:[INST]:MOT:MTR0n0m.ADEL</span></code>: Sets the archiver deadband. This will stop values being written to the archiver unless the value changes by more than the deadband value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IN:[INST]:MOT:MTR0n0m_EDEL_SP</span></code>: Sets the encoder deadband. No readbacks will be updated unless the encoder varies by this amount.</p></li>
</ul>
</section>
<section id="mclennan-opi-controls-all-red">
<h3>McLennan OPI controls all red<a class="headerlink" href="#mclennan-opi-controls-all-red" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Does the panel on the front of the controller display a letter?</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code></p>
<ul>
<li><p>Can happen owing to a communication issue when the IOC starts if the baud rate/stop bits aren’t set correctly</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code></p>
<ul>
<li><p>Tracking abort. Usually happens if the encoder resolution is incorrect. Is the <code class="docutils literal notranslate"><span class="pre">ERES</span></code> macro fraction the right way around?</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code></p>
<ul>
<li><p>Observed once on Merlin after the McLennan had been idle for a long time. Only happened after homing the motor. Restarting the controller (with the IOC stopped) fixed the issue</p></li>
</ul>
</li>
<li><p>No</p>
<ul>
<li><p>Try restarting the IOC, then move the motor through a significant operation (a home or jog to limit). Sometimes restarting the IOC is enough, sometimes the move causes the underlying issue to reveal itself (see <code class="docutils literal notranslate"><span class="pre">n</span></code> above)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="which-process-owns-a-serial-port">
<h3>which process owns a serial port<a class="headerlink" href="#which-process-owns-a-serial-port" title="Link to this heading"></a></h3>
<p>From an administrator (i.e. gamekeeper) prompt, run the <code class="docutils literal notranslate"><span class="pre">sysinternals</span></code> handle command like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">handle</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">a</span> <span class="o">|</span> <span class="n">findstr</span> <span class="s2">&quot;Serial pid:&quot;</span>
</pre></div>
</div>
<p>This will print a list of PIDs and any matches to a serial port allocated, take the pid number above the relevant \Device\Serial  line</p>
</section>
</section>
<section id="ioc-troubleshooting-logging">
<h2>Logging<a class="headerlink" href="#ioc-troubleshooting-logging" title="Link to this heading"></a></h2>
<section id="i-changed-the-logging-setting-but-it-uses-old-settings">
<h3>I Changed the logging setting but it uses old settings<a class="headerlink" href="#i-changed-the-logging-setting-but-it-uses-old-settings" title="Link to this heading"></a></h3>
<p>To sync up changes in logging from the DB file to the logging you must:</p>
<ol class="arabic simple">
<li><p>Restart the IOC so the logging info fields are pushed to the database</p></li>
<li><p>If any new PVs are being archived or settings have been changed the ARINST needs restarting</p></li>
<li><p>The ARACCESS needs restarting so it picks up the configuration changes from the database</p></li>
</ol>
</section>
<section id="there-was-an-error-which-i-have-fixed-but-i-missed-a-log-file">
<h3>There was an error which I have fixed but I missed a log file<a class="headerlink" href="#there-was-an-error-which-i-have-fixed-but-i-missed-a-log-file" title="Link to this heading"></a></h3>
<p>To regenerate log files set the date in the <code class="docutils literal notranslate"><span class="pre">c:\Logs\LOG_last_active_time</span></code> to the time you want to start generating files from, if this is more than delta days ago (2nd line of the log file) increase this number too. Then restart the ARACCESS</p>
</section>
<section id="i-want-to-generate-a-log-file-from-some-pvs-now">
<h3>I want to Generate a Log file from some PVs Now<a class="headerlink" href="#i-want-to-generate-a-log-file-from-some-pvs-now" title="Link to this heading"></a></h3>
<p>This can be done between two dates see <code class="docutils literal notranslate"><span class="pre">...EPICS\ISIS\inst_servers\master\ArchiverAccess\log_file_generator.py</span></code> as an example.</p>
</section>
<section id="value-logs-from-ioc-not-produced-araccess-not-creating-log-files-enginx-stress-rig-not-writing-log-files">
<h3>Value logs from IOC not produced/ARACCESS not creating log files/ENGINX Stress Rig not writing log files<a class="headerlink" href="#value-logs-from-ioc-not-produced-araccess-not-creating-log-files-enginx-stress-rig-not-writing-log-files" title="Link to this heading"></a></h3>
<p>Certain IOCs can be made to generate log files using the <a class="reference internal" href="../../system_components/Logging-from-the-archive.html"><span class="doc std std-doc">ARACCESS component</span></a>, if these are no longer being produced then check:</p>
<ul>
<li><p>ARCCESS console (restart it) This should show a little blurb and should have start and stop lines, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span> <span class="o">@@@</span> <span class="o">@@@</span> <span class="o">@@@</span> <span class="o">@@@</span> <span class="o">@@@</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span> <span class="o">@@@</span> <span class="n">Received</span> <span class="n">a</span> <span class="n">sigChild</span> <span class="k">for</span> <span class="n">process</span> <span class="mf">25052.</span> <span class="n">The</span> <span class="n">process</span> <span class="n">was</span> <span class="n">killed</span> <span class="n">by</span> <span class="n">signal</span> <span class="mi">9</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span> <span class="o">@@@</span> <span class="n">Current</span> <span class="n">time</span><span class="p">:</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span> <span class="o">@@@</span> <span class="n">Child</span> <span class="n">process</span> <span class="ow">is</span> <span class="n">shutting</span> <span class="n">down</span><span class="p">,</span> <span class="n">a</span> <span class="n">new</span> <span class="n">one</span> <span class="n">will</span> <span class="n">be</span> <span class="n">restarted</span> <span class="n">shortly</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span> <span class="o">@@@</span> <span class="o">^</span><span class="n">R</span> <span class="ow">or</span> <span class="o">^</span><span class="n">X</span> <span class="n">restarts</span> <span class="n">the</span> <span class="n">child</span><span class="p">,</span> <span class="o">^</span><span class="n">Q</span> <span class="n">quits</span> <span class="n">the</span> <span class="n">server</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="o">@@@</span> <span class="n">Restarting</span> <span class="n">child</span> <span class="s2">&quot;ARACCESS&quot;</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="o">@@@</span>    <span class="p">(</span><span class="k">as</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Windows</span>\<span class="n">system32</span>\<span class="n">cmd</span><span class="o">.</span><span class="n">exe</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="o">@@@</span> <span class="n">The</span> <span class="n">PID</span> <span class="n">of</span> <span class="n">new</span> <span class="n">child</span> <span class="s2">&quot;ARACCESS&quot;</span> <span class="ow">is</span><span class="p">:</span> <span class="mi">20124</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="o">@@@</span> <span class="o">@@@</span> <span class="o">@@@</span> <span class="o">@@@</span> <span class="o">@@@</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span> <span class="p">[</span><span class="mf">1600935623.82</span><span class="p">]</span> <span class="n">INFO</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">a</span> <span class="n">new</span> <span class="n">connection</span> <span class="n">pool</span><span class="p">:</span> <span class="n">DBSVR_127</span><span class="mf">.0.0.1</span><span class="n">_archive_report</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span> <span class="p">[</span><span class="mf">1600935624.74</span><span class="p">]</span> <span class="n">INFO</span><span class="p">:</span> <span class="n">Creating</span> <span class="n">a</span> <span class="n">new</span> <span class="n">connection</span> <span class="n">pool</span><span class="p">:</span> <span class="n">DBSVR_127</span><span class="mf">.0.0.1</span><span class="n">_iocdb_iocdb</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span> <span class="p">[</span><span class="mf">1600935625.00</span><span class="p">]</span> <span class="n">INFO</span><span class="p">:</span> <span class="n">Reading</span> <span class="n">config</span> <span class="k">for</span> <span class="n">ioc</span><span class="p">:</span> <span class="n">INSTRON_01</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span> <span class="p">[</span><span class="mf">1600935625.00</span><span class="p">]</span> <span class="n">INFO</span><span class="p">:</span> <span class="n">Logging</span> <span class="n">configuration</span> <span class="p">(</span><span class="n">pvs</span> <span class="k">as</span> <span class="n">read</span> <span class="kn">from</span><span class="w"> </span><span class="nn">the</span> <span class="n">archive</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">file</span> <span class="p">(</span><span class="n">log</span> <span class="n">on</span> <span class="n">end</span><span class="p">):</span> <span class="n">C</span><span class="p">:</span>\<span class="n">logs</span>\<span class="n">INSTRON_01</span>\<span class="n">INSTRON_01_</span><span class="p">{</span><span class="n">start_time</span><span class="p">}</span><span class="o">.</span><span class="n">dat</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">file</span> <span class="p">(</span><span class="n">continuous</span><span class="p">):</span> <span class="n">C</span><span class="p">:</span>\<span class="n">logs</span>\<span class="n">INSTRON_01</span>\<span class="n">INSTRON_01_</span><span class="p">{</span><span class="n">start_time</span><span class="p">}</span><span class="n">_continuous</span><span class="o">.</span><span class="n">dat</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">trigger</span> <span class="n">pv</span><span class="p">:</span> <span class="n">IN</span><span class="p">:</span><span class="n">ENGINX</span><span class="p">:</span><span class="n">INSTRON_01</span><span class="p">:</span><span class="n">LOG</span><span class="p">:</span><span class="n">RECORD</span><span class="p">:</span><span class="n">SP</span><span class="o">.</span><span class="n">VAL</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">trigger</span> <span class="n">pv</span><span class="p">:</span> <span class="n">Logging</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pv</span> <span class="n">IN</span><span class="p">:</span><span class="n">ENGINX</span><span class="p">:</span><span class="n">INSTRON_01</span><span class="p">:</span><span class="n">LOG</span><span class="p">:</span><span class="n">SCAN</span><span class="o">.</span><span class="n">VAL</span> <span class="k">with</span> <span class="n">a</span> <span class="n">default</span> <span class="n">on</span> <span class="n">error</span> <span class="n">of</span> <span class="mi">1</span><span class="n">s</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">file</span> <span class="n">headers</span><span class="p">:</span> <span class="p">[</span><span class="sa">u</span><span class="s1">&#39;Cross Sectional Area = </span><span class="si">{1:.6f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Gauge Length for Strain = </span><span class="si">{2:.6f}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;RB Number = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">pvs</span> <span class="ow">in</span> <span class="n">fileheader</span> <span class="p">[</span><span class="s1">&#39;IN:ENGINX:ED:RBNUMBER.VAL&#39;</span><span class="p">,</span> <span class="s1">&#39;IN:ENGINX:INSTRON_01:STRESS:AREA.VAL&#39;</span><span class="p">,</span>         <span class="s1">&#39;IN:ENGINX:INSTRON_01:STRAIN:LENGTH.VAL&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">table</span> <span class="n">headers</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Date/time&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Run Number&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Position (mm)&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Load (MPa)&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Strain (%)&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">table</span> <span class="n">line</span><span class="p">:</span> <span class="p">{</span><span class="n">time</span><span class="p">}</span>	<span class="p">{</span><span class="mi">2</span><span class="p">}</span>	<span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mf">.6</span><span class="n">f</span><span class="p">}</span>	<span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">.6</span><span class="n">f</span><span class="p">}</span>	<span class="p">{</span><span class="mi">3</span><span class="p">:</span><span class="mf">.6</span><span class="n">f</span><span class="p">}</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>   <span class="o">-</span> <span class="n">pvs</span> <span class="ow">in</span> <span class="n">table</span> <span class="n">line</span> <span class="p">[</span><span class="s1">&#39;IN:ENGINX:INSTRON_01:POS.VAL&#39;</span><span class="p">,</span> <span class="s1">&#39;IN:ENGINX:INSTRON_01:STRESS.VAL&#39;</span><span class="p">,</span> <span class="s1">&#39;IN:ENGINX:DAE:RUNNUMBER.VAL&#39;</span><span class="p">,</span> <span class="s1">&#39;IN:ENGINX:INSTRON_01:STRAIN.VAL&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span> <span class="mi">09</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span> <span class="p">[</span><span class="mf">1600935625.01</span><span class="p">]</span> <span class="n">INFO</span><span class="p">:</span> <span class="n">Last</span> <span class="n">active</span><span class="p">:</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">24</span><span class="n">T09</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">31</span> <span class="p">(</span><span class="mi">13469489</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If this doesn’t show both start and stop lines which that it is set to auto start in the default block component</p></li>
</ul>
</li>
<li><p>Start and stop the logging and see if it says it is creating a file, e.g. <code class="docutils literal notranslate"><span class="pre">INFO:</span> <span class="pre">Writing</span> <span class="pre">log</span> <span class="pre">file</span> <span class="pre">'...'</span></code> is this in the expected place</p></li>
<li><p>Check the PVs it says it is logging and monitoring do they exist?</p></li>
<li><p>Next check the ARINST level is it up (check <code class="docutils literal notranslate"><span class="pre">http://localhost:4812/groups</span></code>)</p>
<ul class="simple">
<li><p>if not restart it, this means that there is no data stored for the run</p></li>
</ul>
</li>
<li><p>Next step is to check that the data is getting into the database (probably plot on log plotter)</p></li>
<li><p>Write tip on Wiki for importing a database dump file into local database.  Commands and output:</p></li>
</ul>
</section>
<section id="reading-historical-pv-values-from-local-database-after-it-has-been-backed-up-and-truncated">
<h3>Reading historical PV values from local database <em>after</em> it has been backed up and truncated<a class="headerlink" href="#reading-historical-pv-values-from-local-database-after-it-has-been-backed-up-and-truncated" title="Link to this heading"></a></h3>
<p>This can be done by <em>importing</em> the backed-up database (usually on a network drive) into a local developer’s copy, then reading/plotting from there.
Example command from a request to read chopper values on MERLIN:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span> <span class="p">[</span><span class="n">insert</span> <span class="n">network</span> <span class="n">back</span><span class="o">-</span><span class="n">up</span> <span class="n">path</span> <span class="n">here</span><span class="p">]</span>\<span class="n">ndxMERLIN</span>\<span class="n">ibex_database_backup_2024_01_30</span>\<span class="n">ibex_db_sqldump_2024_01_30</span><span class="o">.</span><span class="n">sql</span>
<span class="n">Enter</span> <span class="n">password</span><span class="p">:</span> <span class="o">************</span>
</pre></div>
</div>
<p>This <a class="reference external" href="https://github.com/ISISComputingGroup/EPICS/blob/master/utils/query_ioclog.bat">script</a> can be used to extract data into CSV file(s) for e.g. diagnostic purposes.</p>
<p>The local database can then be truncated to remove the import once work is complete.</p>
</section>
<section id="epics-ca-max-array-bytes">
<h3><code class="docutils literal notranslate"><span class="pre">EPICS_CA_MAX_ARRAY_BYTES</span></code><a class="headerlink" href="#epics-ca-max-array-bytes" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">EPICS_CA_MAX_ARRAY_BYTES</span></code> constant is used throughout ibex to specify the size of the largest waveform (which is usually produced by the dae). Large objects are need especially for (Live View)[/specific_iocs/dae/DAE-Live-View]. Currently the largest know version of this is on POLREF who want to see their linear detector with a time of flight 2D view. This has the size of:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>5001 (time channels) * 640 * 8 ~ 20M
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Dependency-Walker.html" class="btn btn-neutral float-left" title="DLL Dependency Walker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="IOC-Start-Example.html" class="btn btn-neutral float-right" title="IOC Startup Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">Last updated on Oct 31, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>